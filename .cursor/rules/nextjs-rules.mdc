---
description: ACEDD NGO website & admin panel â€“ Next.js 15 / React 19 / TypeScript 5 / Tailwind 4 / Prisma + MariaDB
alwaysApply: true
globs:
  - "src/**/*.{ts,tsx}"
---

# ACEDD â€“ Project Rules for Cursor

You are working inside the **ACEDD NGO** full-stack Next.js project.

Your goals:

1. **Preserve** the existing architecture, routes, and domain language (Turkish field names, statuses, etc.).
2. **Extend** the admin panel and public site in a consistent, maintainable way.
3. **Use Prisma + MariaDB** as the single source of truth for all data operations (Sprint 6: MongoDB migration completed).

---

## 1. Project scope & architecture

- Framework: **Next.js 15 App Router** (`src/app`).
- Language: **TypeScript** with `strict` mode.
- UI: **React 19** function components + hooks.
- Styling: **Tailwind CSS v4** â€“ prefer class utilities over inline styles.
- Database:
  - **Prisma + MariaDB** (`prisma/schema.prisma`, `src/lib/db.ts`) â€“ **Single source of truth**
  - MongoDB migration tamamlandÄ± (Sprint 6: `src/lib/mongodb.ts` artÄ±k yok)
- App segments:
  - Public site: `src/app/(pages)/**`
  - Admin panel: `src/app/(admin)/admin/**`
  - API routes: `src/app/api/**`
  - Shared logic: `src/contexts/**`, `src/lib/**`, `src/components/**`

Always keep a **clear separation** between:

- UI components
- Data-fetching / API layer
- Database access (Prisma + MariaDB)

---

## 2. Folder structure conventions

Follow and extend the existing structure:

- **Public pages** (`src/app/(pages)`):
  - Route folders:  
    - `/` (home), `/etkinlikler`, `/hakkimizda`, `/burs-basvuru`, `/uyelik-basvuru`, `/bagis-yap`, `/iletisim`, etc.
  - Inside each route:
    - `page.tsx` â€“ main page component.
    - `constants.ts` â€“ domain types and static content.
    - `components/` â€“ page-specific UI pieces.

- **Admin panel** (`src/app/(admin)/admin`):
  - `layout.tsx` â€“ admin layout wrapper.
  - `components/AdminLayout.tsx` â€“ sidebar, header, main content.
  - Feature folders:
    - `admin/page.tsx` â€“ Dashboard
    - `admin/burs-basvurulari/page.tsx`
    - `admin/uyeler/page.tsx`
    - `admin/etkinlikler/page.tsx`
    - `admin/duyurular/page.tsx`
    - `admin/ayarlar/page.tsx`
  - Reusable admin UI belongs in `admin/components/`.

- **API routes** (`src/app/api`):
  - `members`, `membership-applications`, `board-members`, `events`, `datasets`, `upload`, `scholarship-applications`, etc.
  - A debug route for Prisma: `api/debug/prisma-test/route.ts`.

- **Shared modules**:
  - `src/contexts/*` â€“ React Contexts (Members, Events, future Announcements).
  - `src/lib/types/*` â€“ domain types (Member, MembershipApplication, BoardMember, Event, Announcement, ScholarshipApplication, etc.).
  - `src/lib/constants/*` â€“ global constants and configuration.
  - `src/lib/hooks/*` â€“ shared hooks.
  - `src/lib/utils/*` â€“ helpers (e.g. `cn`, `memberHelpers`, validation helpers).
  - `src/lib/db.ts` â€“ Prisma client (MariaDB) â€“ **Single source of truth for database access**
  - `src/lib/auth/*` â€“ Admin authentication & authorization helpers (HMAC session, role-based access)

- **Component organization** â€“ **CRITICAL: Follow this structure strictly**

  **1. Shared/Reusable Components** (`src/components/`):
  
  - `src/components/ui/` â€“ **UI primitives** (generic, reusable building blocks)
    - Examples: `Button`, `Input`, `Card`, `Select`, `Textarea`, `Badge`, `FileUpload`
    - These have NO domain logic, NO business rules
    - Can be used anywhere in the app (public pages, admin panel, etc.)
  
  - `src/components/layout/` â€“ **Layout components** (site-wide structure)
    - Examples: `Header`, `Footer`, `ConditionalLayout`
    - These define the overall page structure
    - Used across multiple routes/pages

  **2. Page-Specific Components** (`src/app/(pages)/<route>/components/`):
  
  - **Public page components** â€“ Components used ONLY in a specific public page
    - Examples:
      - `src/app/(pages)/home/components/HeroSection.tsx` (only on homepage)
      - `src/app/(pages)/home/components/AnnouncementStrip.tsx` (only on homepage)
      - `src/app/(pages)/home/components/AnnouncementStripSection.tsx` (only on homepage)
      - `src/app/(pages)/etkinlikler/components/EventsGrid.tsx` (only on events page)
    - **Rule:** Even if a component is domain-specific (e.g., announcement-related), if it's ONLY used in one page, it belongs in that page's `components/` folder
  
  - Each route folder structure:
    ```
    src/app/(pages)/<route>/
      â”œâ”€â”€ page.tsx
      â”œâ”€â”€ constants.ts
      â”œâ”€â”€ components/
      â”‚   â”œâ”€â”€ ComponentName.tsx
      â”‚   â””â”€â”€ index.ts
      â””â”€â”€ hooks/ (optional)
    ```

  **3. Admin-Specific Components** (`src/app/(admin)/admin/components/`):
  
  - **Admin panel components** â€“ Components used ONLY in admin panel
    - Examples:
      - `AdminLayout.tsx` (admin layout wrapper)
      - `AdminAnnouncementsTable.tsx` (admin announcements management)
      - `AnnouncementFormDialog.tsx` (admin announcement form)
      - `AnnouncementsSummaryWidget.tsx` (admin dashboard widget)
    - **Rule:** All admin-specific components stay in `admin/components/`, even if they're domain-specific

**Component placement decision tree:**

1. **Is it a generic UI primitive?** (button, input, card, select, etc.)
   â†’ `src/components/ui/`
   - âœ… No domain logic
   - âœ… Reusable across entire app

2. **Is it a layout component?** (header, footer, sidebar, conditional layout)
   â†’ `src/components/layout/`
   - âœ… Site-wide structure
   - âœ… Used across multiple routes

3. **Is it admin-specific?** (only used in admin panel)
   â†’ `src/app/(admin)/admin/components/`
   - âœ… Admin dashboard widgets
   - âœ… Admin management tables/forms
   - âœ… Admin-specific layouts

4. **Is it page-specific?** (used in only ONE public page/route)
   â†’ `src/app/(pages)/<route>/components/`
   - âœ… Home page components â†’ `home/components/`
   - âœ… Events page components â†’ `etkinlikler/components/`
   - âœ… Contact page components â†’ `iletisim/components/`
   - **Important:** Even domain-specific components (announcements, events, etc.) go here if they're only used in one page

5. **Is it shared across MULTIPLE pages?** (used in 2+ different routes)
   â†’ `src/components/<domain>/`
   - âš ï¸ **Rare case** â€“ Only use this if a component is truly shared across multiple pages
   - Example: Future `EventCard` used in both events list page AND homepage
   - **Default:** Prefer page-specific placement unless truly needed in multiple places

**Examples:**

- âœ… `src/components/ui/Button.tsx` â€“ Generic UI primitive
- âœ… `src/components/layout/Header.tsx` â€“ Site-wide layout
- âœ… `src/app/(pages)/home/components/AnnouncementStrip.tsx` â€“ Home page only
- âœ… `src/app/(pages)/home/components/AnnouncementStripSection.tsx` â€“ Home page only
- âœ… `src/app/(admin)/admin/components/AnnouncementFormDialog.tsx` â€“ Admin only
- âŒ `src/components/announcements/` â€“ Don't create unless truly shared across multiple pages

When you add new functionality:

- **Domain types** â†’ `src/lib/types/<domain>.ts`
- **API endpoints** â†’ `src/app/api/<domain>/**`
- **Admin pages** â†’ `src/app/(admin)/admin/<domain>/page.tsx`
- **Public UI components** â†’ Follow the decision tree above

---

## 3. Coding standards & quality gates

### 3.1. TypeScript & style

- `strict` mode must remain enabled.
- Avoid `any`. If truly necessary:
  - Limit scope,
  - Add a comment explaining why.
- Prefer `type`/`interface` for domain models over ad-hoc inline types.
- Use **ESLint + Prettier** conventions (no custom style unless required by the repo).

### 3.2. Commits & PRs (mental model for changes)

Assume the following workflow and keep diffs compatible with it:

- **Trunk-based development**, feature branches are short-lived.
- Commit messages follow **Conventional Commits**:
  - `feat:`, `fix:`, `refactor:`, `test:`, `chore:`, etc.
- Each PR should be:
  - **< 300 LOC** of meaningful change when possible.
  - Focused on a single feature or refactor.
- Include tests and docs updates in the same PR when you change behavior.

### 3.3. Testing expectations

- New non-trivial business logic (validation, status transitions, filtering, etc.) should live in small pure functions under `src/lib/**` and be unit-testable.
- Aim for:
  - â‰¥ 80% coverage overall,
  - â‰¥ 90% on critical modules (auth, payments/donations, admin actions).
- **âš ï¸ CRITICAL: API Domain Testing Requirement (Sprint 6)**
  - **Her yeni API domain'i iÃ§in en az 1â€“2 Vitest testi zorunludur**
  - **Her mutating endpoint iÃ§in role testleri zorunludur** (Sprint 6)
  - Test coverage:
    - Happy path (successful operations)
    - Validation errors (400)
    - Authentication errors (401 - UNAUTHORIZED)
    - Authorization errors (403 - FORBIDDEN)
    - Database errors (500)
    - Not found errors (404)
  - Test dosyasÄ±: `src/app/api/<domain>/__tests__/route.test.ts` veya `src/app/api/<domain>/[id]/__tests__/route.test.ts`
  - **Role Test Pattern:**
    - ADMIN role ile eriÅŸim denemesi â†’ 403 FORBIDDEN (SUPER_ADMIN gereken yerler iÃ§in)
    - UNAUTHORIZED (session yok) â†’ 401
    - SUPER_ADMIN role ile eriÅŸim â†’ 200/201 baÅŸarÄ±lÄ±
  - **Do not:**
    - âŒ Testsiz bÃ¼yÃ¼k API deÄŸiÅŸiklikleri yapma
    - âŒ Yeni domain eklerken test yazmayÄ± atlama
    - âŒ Role testlerini atlama (Sprint 6)
- When you add new APIs:
  - Cover success, validation error, authentication/authorization errors, and generic failure paths.

### 3.4. CI/CD expectations

Design code changes as if CI runs the following pipelines:

1. Install & build
2. TypeScript check
3. ESLint
4. Tests + coverage threshold enforcement
5. Prisma migrations (if schema changed)
6. Dependency audit (no high-severity vulns)

Code you write should be ready to pass all of the above.

### 3.5. Security & secrets

- Never hardcode secrets, tokens, or connection strings.
- Use environment variables (e.g. `DATABASE_URL`) loaded outside the repo.
- When logging errors:
  - Log enough to debug,
  - Do **not** log sensitive data (passwords, personal details, etc.).
- For admin features:
  - Assume they must be protected by authentication (even if not fully implemented yet).
  - Do not rely on â€œhidden URLsâ€ as security.

---

### 3.6. Authentication & Authorization (Admin)

**âš ï¸ CRITICAL: Admin EriÅŸim KurallarÄ±**

- **Admin authentication:** `AdminUser` modeli ve `AdminRole` enum'u kullanÄ±lÄ±r
- **Admin roles:** `SUPER_ADMIN` ve `ADMIN` rolleri mevcuttur
  - `SUPER_ADMIN`: TÃ¼m modÃ¼llere tam eriÅŸim
  - `ADMIN`: ModÃ¼l bazlÄ± eriÅŸim (rol bazlÄ± izinler)
- **Admin route protection:** TÃ¼m `/admin/*` rotalarÄ± **her zaman** bir auth/role kontrolÃ¼nden geÃ§meli
  - API route'larÄ±: Middleware veya route handler iÃ§inde auth kontrolÃ¼
  - Page route'larÄ±: Server Component veya middleware ile auth kontrolÃ¼

**âš ï¸ CRITICAL: Session Security (Sprint 6)**

- **Session Management:** HMAC-SHA256 signed cookies kullanÄ±lÄ±r
  - Cookie format: `base64(payload).hex(hmac)`
  - Signature verification: Timing-safe comparison ile doÄŸrulanÄ±r
  - Session secret: `SESSION_SECRET` environment variable'dan alÄ±nÄ±r
  - **ASLA** Base64-only encoding kullanma (gÃ¼venlik riski)
  - **ASLA** session secret'i hardcode etme
- **Session Helpers:**
  - `src/lib/auth/adminSession.ts` â€“ Session encryption/decryption (HMAC-SHA256)
  - `src/lib/auth/adminAuth.ts` â€“ `requireRole()`, `requireAuth()`, `getAdminFromRequest()`
  - `src/middleware.ts` â€“ Edge Runtime uyumlu session validation (Web Crypto API)
- **Security Features:**
  - HttpOnly cookies (JavaScript eriÅŸimi yok)
  - Secure flag (production'da HTTPS zorunlu)
  - SameSite=Lax (CSRF korumasÄ±)
  - Timing-safe signature comparison (timing attack korumasÄ±)

**âš ï¸ CRITICAL: Role-Based Access Control (Sprint 6)**

- **API Level Protection:**
  - TÃ¼m mutating API endpoint'leri (`POST`, `PUT`, `DELETE`) **MUTLAKA** `requireRole()` kullanmalÄ±
  - Role matrisi:
    - **Members** (POST/PUT/DELETE): `SUPER_ADMIN` only
    - **Membership Applications** (PUT/DELETE): `SUPER_ADMIN` only
    - **Board Members** (POST/PUT/DELETE): `SUPER_ADMIN` only
    - **Datasets** (POST/PUT/DELETE): `ADMIN` + `SUPER_ADMIN`
    - **Announcements** (POST/PUT/DELETE): `ADMIN` + `SUPER_ADMIN`
    - **Events** (POST/PUT/DELETE): `ADMIN` + `SUPER_ADMIN`
    - **Scholarship Applications** (GET/PUT/DELETE): `ADMIN` + `SUPER_ADMIN` (POST is public for form submission)
    - **Contact Messages** (GET/PUT): `ADMIN` + `SUPER_ADMIN`, DELETE: `SUPER_ADMIN` only (POST is public for form submission)
  - GET endpoint'leri genellikle public (admin paneli iÃ§in middleware korumalÄ±)
- **UI Level Protection:**
  - Admin menÃ¼ Ã¶ÄŸeleri role bazlÄ± filtreleme (`hasRole()` helper)
  - Admin panel sayfalarÄ± middleware ile korumalÄ±
- **Do not:**
  - âŒ Admin sayfalarÄ±nÄ± auth kontrolÃ¼ olmadan bÄ±rakma
  - âŒ "Hidden URL" gÃ¼venliÄŸi kullanma
  - âŒ Role kontrolÃ¼ olmadan admin iÅŸlemleri yapma
  - âŒ API endpoint'lerini role kontrolÃ¼ olmadan bÄ±rakma

---

## 4. Data layer rules (Prisma + MariaDB)

**Sprint 6: MongoDB migration tamamlandÄ±** â€“ ArtÄ±k tÃ¼m veri iÅŸlemleri Prisma + MariaDB kullanÄ±yor.

### 4.1. Prisma + MariaDB (Single Source of Truth)

- `prisma/schema.prisma` defines models such as:
  - `AdminUser` + `AdminRole` enum
  - `Announcement`
  - `Member`
  - `MembershipApplication`
  - `BoardMember`
  - `Event`
  - `ScholarshipApplication` (Sprint 7)
  - and potential CMS models (`Page`, `ContentBlock`, etc.).
- `src/lib/db.ts` must be the **only place** where `PrismaClient` is instantiated.
  - Use the MariaDB adapter.
  - Use the global singleton pattern for dev.

**Rules for new features:**

1. **All new persistent data must use Prisma.**
2. Frontend types for domain entities should mirror Prisma models:
   - Use explicit DTOs if you donâ€™t want to expose all fields.
3. UI components must not import `prisma` directly.
   - Use API routes (`src/app/api/**`) or server actions instead.

**âš ï¸ Critical: Schema Change Workflow (Sprint 6 - Production Ã–ncesi)**

When adding new models or fields, **always follow this order:**

1. **First:** Update `prisma/schema.prisma` with your changes
   - Add/modify models, fields, indexes, enums, etc.
   - `schema.prisma` is the **single source of truth**

2. **Second:** Generate Prisma Client:
   ```bash
   npx prisma generate
   ```
   This regenerates the Prisma Client with new schema types.

3. **Third:** Apply schema to database (Production Ã–ncesi):
   ```bash
   npx prisma db push
   ```
   - âœ… Applies schema directly to database (no migration files)
   - âœ… No shadow database required
   - âŒ Migration files are NOT created (acceptable for pre-production)

4. **Fourth:** Update TypeScript types and API handlers
   - Prisma Client is already regenerated
   - Update `src/lib/types/*` if needed
   - Update API routes to use new schema

**âš ï¸ CRITICAL: Production Ã–ncesi Strateji (Sprint 6)**
- **SADECE** `prisma db push` kullan (migration dosyasÄ± Ã¼retilmez)
- **ASLA** `prisma migrate dev` kullanma (shadow DB gerektirir, ÅŸu an kullanÄ±lmÄ±yor)
- **ASLA** `prisma migrate deploy` kullanma (migration dosyasÄ± yok)

**Never:**
- âŒ Modify database directly without updating `schema.prisma` first
- âŒ Use `prisma migrate dev` in pre-production (shadow DB not available)
- âŒ Use `prisma migrate deploy` in pre-production (no migration files)

**Note:** Ä°lk prod release sonrasÄ± `prisma migrate dev` ve `prisma migrate deploy` kullanÄ±lacak, ancak ÅŸu an iÃ§in sadece `prisma db push` kullan.

### 4.2.1. Prisma Migration Strategy

**âš ï¸ CRITICAL: Production Ã–ncesi DB Stratejisi (Sprint 6)**

**Åu Anki Durum (Production Ã–ncesi):**
- Tek DB kullanÄ±lÄ±yor (geliÅŸtirme ve ilk yayÄ±n iÃ§in)
- **SADECE** `npx prisma db push` kullanÄ±lÄ±r (migration dosyasÄ± Ã¼retilmez, shadow DB gerekmez)
- Schema deÄŸiÅŸiklikleri direkt DB'ye uygulanÄ±r
- Test iÃ§in: `npx prisma studio` ile tablolarÄ± kontrol edebilirsiniz

**ASLA kullanma (Production Ã–ncesi):**
- âŒ `prisma migrate dev` (shadow DB gerektirir, ÅŸu an kullanÄ±lmÄ±yor)
- âŒ `prisma migrate deploy` (migration dosyasÄ± yok, ÅŸu an kullanÄ±lmÄ±yor)

**Workflow Ã¶zeti (Production Ã–ncesi):**
1. Schema deÄŸiÅŸikliÄŸi: `prisma/schema.prisma` gÃ¼ncelle
2. Prisma Client'Ä± gÃ¼ncelle: `npx prisma generate`
3. DB'ye uygula: `npx prisma db push` (migration dosyasÄ± Ã¼retilmez, shadow DB gerekmez)
4. Test: `prisma studio` veya test route

**Ä°lk Prod Release SonrasÄ±:**
- Åu anki DB prod sayÄ±lacak
- AyrÄ± dev DB aÃ§Ä±lacak
- Dev DB'de `prisma migrate dev`, prod DB'de `prisma migrate deploy` kullanÄ±lacak

**Critical rules for database migrations (Ä°lk Prod Release SonrasÄ±):**

#### ğŸ”¹ Kural 1 â€“ Production (Plesk) Ã¼zerinde asla `prisma migrate dev` Ã§alÄ±ÅŸtÄ±rma

**âš ï¸ CRITICAL: Production'da ASLA `prisma migrate dev` kullanma!**

- **Production/Plesk'te sadece:**
  ```bash
  npx prisma migrate deploy
  ```
- Migration dosyalarÄ± zaten lokalinde Ã¼retilmiÅŸ ve test edilmiÅŸ olacak.
- `prisma migrate dev` shadow database gerektirir ve production DB kullanÄ±cÄ±sÄ±nÄ±n yeni DB oluÅŸturma yetkisi olmayabilir.
- `prisma migrate dev` yeni migration dosyasÄ± oluÅŸturur (production'da istenmez).
- Production'da sadece mevcut migration dosyalarÄ±nÄ± uygulamak iÃ§in `prisma migrate deploy` kullan.

**Production migration checklist:**
- [ ] Migration dosyalarÄ± local'de oluÅŸturuldu ve test edildi
- [ ] Migration dosyalarÄ± commit edildi
- [ ] Kod Plesk'e deploy edildi
- [ ] Plesk'te `npx prisma migrate deploy` Ã§alÄ±ÅŸtÄ±rÄ±ldÄ± (ASLA `migrate dev` deÄŸil!)

#### ğŸ”¹ Kural 2 â€“ Shadow DB (Otomatik)

**Åu Anki Strateji (Sprint 0 - Prod Release Ã–ncesi):**
- Tek DB kullanÄ±lÄ±yor (geliÅŸtirme ve ilk yayÄ±n iÃ§in)
- Schema deÄŸiÅŸiklikleri iÃ§in `prisma db push` kullanÄ±lÄ±r
  - âœ… Tablo/kolonlar direkt DB'de gÃ¼ncellenir
  - âœ… Shadow DB'ye ihtiyaÃ§ duymaz
  - âŒ Migration dosyasÄ± Ã¼retilmez (ÅŸimdilik sorun deÄŸil)
- Test iÃ§in: `npx prisma studio` ile tablolarÄ± kontrol edebilirsiniz

**Ä°lk Prod Release SonrasÄ±:**
- Åu anki DB prod sayÄ±lacak
- AyrÄ± dev DB aÃ§Ä±lacak
- Dev DB'de `prisma migrate dev`, prod DB'de `prisma migrate deploy` kullanÄ±lacak

#### ğŸ”¹ Kural 3 â€“ `prisma db push` (Åu Anki Strateji - Prod Release Ã–ncesi)

**âš ï¸ CRITICAL: Production Ã–ncesi DB Stratejisi**

**Åu Anki Durum (Production Ã–ncesi):**
- **SADECE** `npx prisma db push` kullanÄ±lÄ±r (migration dosyasÄ± Ã¼retilmez)
- Shadow DB'ye ihtiyaÃ§ duymaz
- Schema deÄŸiÅŸiklikleri direkt DB'ye uygulanÄ±r
- Test iÃ§in: `npx prisma studio` ile tablolarÄ± kontrol edebilirsiniz

**ASLA kullanma:**
- âŒ `prisma migrate dev` (shadow DB gerektirir, ÅŸu an kullanÄ±lmÄ±yor)
- âŒ `prisma migrate deploy` (migration dosyasÄ± yok, ÅŸu an kullanÄ±lmÄ±yor)

**Prod Release SonrasÄ±:**
- `prisma db push` artÄ±k kullanÄ±lmayacak
- Dev DB'de `prisma migrate dev` + migration dosyalarÄ± kullanÄ±lacak
- Prod DB'de `prisma migrate deploy` kullanÄ±lacak
- `db push` migration geÃ§miÅŸi oluÅŸturmaz, prod release sonrasÄ± kabul edilemez

**Workflow Ã¶zeti (Åu An - Production Ã–ncesi):**
1. Schema deÄŸiÅŸikliÄŸi: `prisma/schema.prisma` gÃ¼ncelle
2. DB'ye uygula: `npx prisma db push` (migration dosyasÄ± Ã¼retilmez, shadow DB gerekmez)
3. Test: `prisma studio` veya test route

**âš ï¸ CRITICAL: Production Ã–ncesi Strateji**
- **ASLA** `prisma migrate dev` kullanma (shadow DB gerektirir, ÅŸu an kullanÄ±lmÄ±yor)
- **ASLA** `prisma migrate deploy` kullanma (migration dosyasÄ± yok)
- **SADECE** `prisma db push` kullan (production Ã¶ncesi iÃ§in yeterli)

**Workflow Ã¶zeti (Prod Release SonrasÄ±):**
1. Dev DB'de: `prisma migrate dev` (shadow DB ile)
2. Migration dosyalarÄ±nÄ± commit et
3. Production deploy: `prisma migrate deploy` (shadow DB gerekmez)

### 4.3. Scholarship Applications (Burs BaÅŸvurularÄ±) - Sprint 7

**Yeni ModÃ¼l: ScholarshipApplication (Sprint 7)**

- **API Ä°simlendirmesi:** `/api/scholarship-applications`
- **Prisma Model:** `ScholarshipApplication` (kapsamlÄ± alanlar: genel bilgi, banka, Ã¼niversite, saÄŸlÄ±k, aile, JSON fields)
- **TypeScript Types:** `src/lib/types/scholarship.ts`
  - `ScholarshipApplicationStatus`: `"PENDING" | "APPROVED" | "REJECTED" | "UNDER_REVIEW"`
  - `ScholarshipApplication` interface
  - `CreateScholarshipApplicationRequest` interface
  - `UpdateScholarshipApplicationStatusRequest` interface
  - Nested types: `ScholarshipRelative`, `ScholarshipEducationHistory`, `ScholarshipReference`
- **API Endpoints:**
  - POST `/api/scholarship-applications` (Public - form submission)
  - GET `/api/scholarship-applications` (Admin - list with filters)
  - GET `/api/scholarship-applications/[id]` (Admin - detail)
  - PUT `/api/scholarship-applications/[id]` (Admin - status update)
  - DELETE `/api/scholarship-applications/[id]` (Admin - deletion)
- **Admin Panel:** `src/app/(admin)/admin/burs-basvurulari/page.tsx`
- **Public Form:** `src/app/(pages)/burs-basvuru/components/ScholarshipForm.tsx`
- **RBAC:** GET/PUT/DELETE iÃ§in `requireRole(["SUPER_ADMIN", "ADMIN"])`, POST public
- **Test Pattern:** `src/app/api/scholarship-applications/__tests__/route.test.ts` ve `[id]/__tests__/route.test.ts`

### 4.3.1. Contact Messages (Ä°letiÅŸim MesajlarÄ±) - Sprint 8

**Yeni ModÃ¼l: ContactMessage (Sprint 8)**

- **API Ä°simlendirmesi:** `/api/contact-messages`
- **Prisma Model:** `ContactMessage` (basit alanlar: fullName, email, phone?, subject, message, metadata: ipAddress, userAgent, status management)
- **TypeScript Types:** `src/lib/types/contact.ts`
  - `ContactMessageStatus`: `"NEW" | "READ" | "ARCHIVED"`
  - `ContactMessage` interface
  - `CreateContactMessageRequest` interface (form'da `name` â†’ backend'de `fullName`)
  - `UpdateContactMessageStatusRequest` interface
- **API Endpoints:**
  - POST `/api/contact-messages` (Public - form submission, metadata extraction: ipAddress, userAgent)
  - GET `/api/contact-messages` (Admin - list with filters: status, search)
  - GET `/api/contact-messages/[id]` (Admin - detail)
  - PUT `/api/contact-messages/[id]` (Admin - status update: READ/ARCHIVED, auto-set readAt/archivedAt)
  - DELETE `/api/contact-messages/[id]` (SUPER_ADMIN only - deletion)
- **Admin Panel:** `src/app/(admin)/admin/iletisim-mesajlari/page.tsx`
- **Public Form:** `src/app/(pages)/iletisim/components/ContactForm.tsx`
- **RBAC:** GET/PUT iÃ§in `requireRole(["SUPER_ADMIN", "ADMIN"])`, DELETE iÃ§in `requireRole(["SUPER_ADMIN"])`, POST public
- **Test Pattern:** `src/app/api/contact-messages/__tests__/route.test.ts` ve `[id]/__tests__/route.test.ts`

**Yeni Domain Ekleme Pattern'i (Sprint 7):**

Yeni bir domain eklerken ÅŸu pattern'i takip et:

1. **Prisma Model:** `prisma/schema.prisma` iÃ§inde model tanÄ±mla
2. **TypeScript Types:** `src/lib/types/<domain>.ts` oluÅŸtur
3. **API Routes:** `src/app/api/<domain>/route.ts` ve `[id]/route.ts` oluÅŸtur
4. **Admin Panel:** `src/app/(admin)/admin/<domain>/page.tsx` oluÅŸtur
5. **Tests:** `src/app/api/<domain>/__tests__/route.test.ts` ve `[id]/__tests__/route.test.ts` oluÅŸtur
6. **RBAC:** Mutating endpoint'ler iÃ§in `requireRole()` kullan
7. **Error Handling:** 400, 401, 403, 404, 500 status codes iÃ§in proper error handling

**Referans Ã–rnekler:**
- **Scholarship Applications (Sprint 7):** KapsamlÄ± form, JSON fields, nested arrays
- **Contact Messages (Sprint 8):** Basit form, metadata extraction (ipAddress, userAgent), status management (NEW â†’ READ â†’ ARCHIVED)

### 4.4. Announcements (Duyurular) as the first fully Prisma feature

**Prisma model (already exists conceptually):**

- `Announcement`:
  - `id` (uuid),
  - `title`, `summary`, `content`,
  - `category` (string; may later become enum),
  - `startsAt`, `endsAt`,
  - `isPinned` (boolean),
  - `createdAt`, `updatedAt`,
  - indexes on `category`, `isPinned`, `startsAt`.

**TypeScript type:**

Create `src/lib/types/announcement.ts`:

```ts
export type AnnouncementCategory =
  | "general"
  | "scholarship"
  | "event"
  | "system"
  | string; // allow future/custom categories

export interface Announcement {
  id: string;
  title: string;
  summary?: string;
  content: string;
  category: AnnouncementCategory;
  startsAt?: string; // ISO 8601
  endsAt?: string;   // ISO 8601
  isPinned: boolean;
  createdAt: string;
  updatedAt: string;
}
